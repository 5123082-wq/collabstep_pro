# Contributing to Collabverse

> **Последнее обновление:** 2025-11-10

## Начало работы

- Прочитайте [быстрый старт](docs/getting-started/quick-start.md) для начала работы
- Изучите [руководство по настройке](docs/getting-started/setup.md), чтобы подготовить окружение и переменные
- Используйте `pnpm verify` перед пушем: команда запускает линт, typecheck, build, тесты, проверку маршрутов и симуляцию Vercel
- Требования: Node.js 20, pnpm 9+

## Workflow

1. Создайте feature-ветку от `main`
2. Внесите изменения, следуя существующему стилю кода
3. Запустите `pnpm verify` для проверки всех тестов
4. Создайте Pull Request с описанием изменений

## Release checklist

Перед релизом убедитесь, что:

- Выровнены версии Node.js 20 и pnpm 9+
- Структура маршрутов покрыта `page/layout/loading/error/not-found`
- Навигация и доступность проверены e2e-тестами
- Error boundaries реализованы во всех ключевых сегментах
- Конфигурация Vercel обновлена
- Прогон `pnpm verify` проходит успешно

## Правила для AI-помощников

> **Важно:** Эти правила обязательны для всех AI-агентов, работающих с репозиторием.

### Приоритет №1: Прохождение CI проверок

Главная цель — не допускать падения GitHub Actions job `build-test` при открытии pull request.

CI на GitHub запускает следующие команды:

1. `pnpm install --frozen-lockfile`
2. `pnpm ensure-env`
3. `npx playwright install` (или эквивалентная команда установки браузеров)
4. `pnpm -w lint`
5. `pnpm -w typecheck`
6. `pnpm -w test`
7. `pnpm docs:lint`
8. `pnpm docs:links`

### Обязательные правила поведения

- **Всегда считать прохождение этих команд приоритетом №1.**
- **Каждый раз, когда пользователь просит:**
  - подготовить PR,
  - написать команды для коммита/пуша,
  - «можно ли это пушить», «готово ли к PR» и т.п.,
    — **сначала предполагается, что НУЖНО локально прогнать проверки.**

- **В ответах вначале всегда предлагай блок вида:**

  ```bash
  Локальные проверки перед пушем:
  pnpm install --frozen-lockfile
  pnpm ensure-env
  npx playwright install
  pnpm -w lint
  pnpm -w typecheck
  pnpm -w test
  pnpm docs:lint
  pnpm docs:links
  ```

  А уже после этого — команды git (add/commit/push) или текст PR.

- **Если пользователь присылает лог ошибок из любой из этих команд, задача — В ПЕРВУЮ ОЧЕРЕДЬ исправлять код так, чтобы все команды проходили без ошибок.**
  - Не предлагать `git push` и не формировать PR-описание, пока ошибки логически не исправлены.

- **Если какие-то проверки зависят от переменных окружения или дополнительных шагов, напоминать об этом и явно прописывать необходимые команды/настройки.**

- **При запросе на создание PR или отправку на сервер — всегда спрашивать: "Провести ли локальные проверки перед созданием PR?"**

### Оптимизация

Всегда оптимизировать ответы под то, чтобы код проходил:

- `pnpm -w lint`
- `pnpm -w typecheck`
- `pnpm -w test`
- `pnpm docs:lint`
- `pnpm docs:links`

без ошибок перед отправкой изменений на GitHub.

## Документация

- Карта документации: [docs/README.md](docs/README.md)
- Быстрый старт: [docs/getting-started/quick-start.md](docs/getting-started/quick-start.md)
- Настройка окружения: [docs/getting-started/setup.md](docs/getting-started/setup.md)
- Системный анализ: [docs/architecture/system-analysis.md](docs/architecture/system-analysis.md)
