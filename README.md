# Collabverse

> **–°—Ç–∞—Ç—É—Å:** –ù–∞—á–∞–ª—å–Ω–∞—è —Å—Ç–∞–¥–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏  
> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-XX

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 20 (—Å–º. `.nvmrc`)
- pnpm 9+

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pnpm install`
2. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: `pnpm ensure-env`
3. –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: `pnpm dev` (–æ—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:3000/`)
4. –ü—Ä–æ–¥–∞–∫—à–µ–Ω-—Å–±–æ—Ä–∫–∞: `pnpm build && pnpm start`

> –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: [docs/getting-started/setup.md](docs/getting-started/setup.md)

## –¢–µ—Å—Ç—ã

- –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã: `pnpm test`
- E2E: `pnpm test:e2e`

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[–ö–∞—Ä—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](docs/README.md)** ‚Äî –ø–æ–ª–Ω—ã–π –æ–±–∑–æ—Ä –≤—Å–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- **[–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](docs/getting-started/quick-start.md)** ‚Äî –Ω–∞—á–Ω–∏—Ç–µ —Ä–∞–±–æ—Ç—É –∑–∞ 5 –º–∏–Ω—É—Ç
- **[–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è](docs/getting-started/setup.md)** ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- **[–ù–∞—Å—Ç—Ä–æ–π–∫–∞ AI (OpenAI)](docs/AI_SETUP_GUIDE.md)** ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ AI-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ ü§ñ
- **[–î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞](docs/development/PLAN.md)** ‚Äî —ç—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **[–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](docs/architecture/system-analysis.md)** ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–π –æ–±–∑–æ—Ä

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `NAV_V1` ‚Äî —Ñ–ª–∞–≥ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (off/on)
- `APP_LOCALE` ‚Äî –ª–æ–∫–∞–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ru)
- `FEATURE_PROJECTS_V1` ‚Äî –≤–∫–ª—é—á–∞–µ—Ç CRM ¬´–ü—Ä–æ–µ–∫—Ç—ã v1¬ª (0/1)
- `AUTH_DEV` ‚Äî –≤–∫–ª—é—á–∞–µ—Ç dev-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (on/off)
- `DEMO_ADMIN_EMAIL`, `DEMO_ADMIN_PASSWORD` ‚Äî —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–µ–º–æ-–∞–¥–º–∏–Ω–∞
- `DEMO_USER_EMAIL`, `DEMO_USER_PASSWORD` ‚Äî —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `FIN_EXPENSES_STORAGE` ‚Äî –≤—ã–±–∏—Ä–∞–µ—Ç –¥—Ä–∞–π–≤–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ (`memory` –∏–ª–∏ `db`). –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ dev ‚Äî `memory`, –≤ staging/prod (`NODE_ENV` –∏–ª–∏ `VERCEL_ENV`) ‚Äî `db`. –ù–∞ Vercel –∑–∞–¥–∞–π—Ç–µ `FIN_EXPENSES_STORAGE=db` –¥–ª—è –æ–∫—Ä—É–∂–µ–Ω–∏–π `staging` –∏ `production`, –∞ –≤ `preview` –æ—Å—Ç–∞–≤—å—Ç–µ `memory`, –µ—Å–ª–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–∞—è –±–∞–∑–∞.
- `NEXT_PUBLIC_FEATURE_*` ‚Äî —Ñ–ª–∞–≥–∏ –≤—Ç–æ—Ä–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è –¥–ª—è UI. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω—ã `NEXT_PUBLIC_FEATURE_FINANCE_GLOBAL=1`, `NEXT_PUBLIC_FEATURE_PROJECTS_OVERVIEW=1` –∏ `NEXT_PUBLIC_FEATURE_CREATE_WIZARD=1`; –æ—Å—Ç–∞–ª—å–Ω—ã–µ (`NEXT_PUBLIC_FEATURE_PROJECT_DASHBOARD`, `NEXT_PUBLIC_FEATURE_TASKS_WORKSPACE`, `NEXT_PUBLIC_FEATURE_BUDGET_LIMITS`, `NEXT_PUBLIC_FEATURE_FINANCE_AUTOMATIONS`) —Å—Ç–∞—Ä—Ç—É—é—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `0` –∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è –ø–æ –º–µ—Ä–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.
- `NEXT_PUBLIC_WS_URL` ‚Äî URL WebSocket —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `http://localhost:8080`). –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, WebSocket –æ—Ç–∫–ª—é—á–µ–Ω –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è polling fallback.
- `NEXT_PUBLIC_WS_ENABLED` ‚Äî —è–≤–Ω–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ WebSocket (`true`/`false`, `1`/`0`, `on`/`off`). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é WebSocket –≤–∫–ª—é—á–µ–Ω, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω `NEXT_PUBLIC_WS_URL`.
- (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) `SKIP_VERCEL_BUILD=1` ‚Äî –æ—Ç–∫–ª—é—á–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é —Å–∏–º—É–ª—è—Ü–∏—é `vercel build` –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç–æ–∫–µ–Ω–∞
- –ù–∞ Vercel —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `NAV_V1=on`, `APP_LOCALE=ru`, `AUTH_DEV=on`, –¥–∞–Ω–Ω—ã–µ –¥–µ–º–æ-–∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏ `FIN_EXPENSES_STORAGE` —Å–æ–≥–ª–∞—Å–Ω–æ –æ–∫—Ä—É–∂–µ–Ω–∏—é (`memory` –¥–ª—è `preview`, `db` –¥–ª—è `staging`/`production`).

–ü—Ä–∏–º–µ—Ä `.env`:

```env
NAV_V1=on
# WebSocket (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω NEXT_PUBLIC_WS_URL, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è polling fallback
# NEXT_PUBLIC_WS_URL=http://localhost:8080
# NEXT_PUBLIC_WS_ENABLED=true
APP_LOCALE=ru
FEATURE_PROJECTS_V1=1
AUTH_DEV=on
FIN_EXPENSES_STORAGE=memory
DEMO_ADMIN_EMAIL=admin.demo@collabverse.test
DEMO_ADMIN_PASSWORD=demo-admin
DEMO_USER_EMAIL=user.demo@collabverse.test
DEMO_USER_PASSWORD=demo-user
```

### Finance Storage

–§–ª–∞–≥ `FIN_EXPENSES_STORAGE` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ in-memory –∏–ª–∏ DB-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é dev-–æ–∫—Ä—É–∂–µ–Ω–∏–µ –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞ `memory`, –∞ staging/prod (–≤ —Ç–æ–º —á–∏—Å–ª–µ Vercel `VERCEL_ENV=staging|production`) –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è –Ω–∞ `db`. –î–ª—è QA –º–æ–∂–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–¥–∞—Ç—å `FIN_EXPENSES_STORAGE=db`, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –±–∞–∑–æ–π, –ª–∏–±–æ –æ—Å—Ç–∞–≤–∏—Ç—å `memory`, —á—Ç–æ–±—ã –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ in-memory —Ä–µ–∂–∏–º.

–ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è –ª–æ–≥ `console.info` –≤–∏–¥–∞ `[ExpenseStoreFactory] selecting expense store` —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –¥—Ä–∞–π–≤–µ—Ä–æ–º; –µ—Å–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è `db` –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –ø–æ—è–≤–ª—è–µ—Ç—Å—è `console.warn` –æ –≤–æ–∑–≤—Ä–∞—Ç–µ –∫ in-memory. –≠—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Å—Ç–æ–∏—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏/–ª–æ–≥–∞—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.

–ù–∞ Vercel —Å–±–æ—Ä–∫–∏ `preview` –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ `memory`, –ø–æ—ç—Ç–æ–º—É –¥–ª—è –ø—Ä–æ–≥–æ–Ω–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –ë–î, –∑–∞–¥–∞–π—Ç–µ `FIN_EXPENSES_STORAGE=db` –≤—Ä—É—á–Ω—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ –∫–æ–º–∞–Ω–¥—É).

## Dev-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –¥–µ–º–æ-–∞–∫–∫–∞—É–Ω—Ç—ã

- –ë—ã—Å—Ç—Ä—ã–π –≤—Ö–æ–¥ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `/login` –∫–Ω–æ–ø–∫–∞–º–∏ ¬´–í–æ–π—Ç–∏ –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º¬ª –∏ ¬´–í–æ–π—Ç–∏ –¥–µ–º–æ-–∞–¥–º–∏–Ω–æ–º¬ª ‚Äî –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö `DEMO_*`.
- POST `/api/auth/login` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç e-mail –∏ –ø–∞—Ä–æ–ª—å –¥–µ–º–æ-–∞–∫–∫–∞—É–Ω—Ç–æ–≤, –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç ¬´–ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ—á—Ç–∞ –∏–ª–∏ –ø–∞—Ä–æ–ª—å¬ª.
- POST `/api/auth/register` (–ø—Ä–∏ `AUTH_DEV=on`) —Å–æ–∑–¥–∞—ë—Ç dev-—Å–µ—Å—Å–∏—é `role=user` –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ `/app/dashboard` —Å —Ç–æ—Å—Ç–æ–º ¬´–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞¬ª.
- POST `/api/auth/logout` –æ—á–∏—â–∞–µ—Ç cookie `cv_session` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞ `/login`.
- –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã `/app/*` –∏ `/project/*` —Ç—Ä–µ–±—É—é—Ç cookie `cv_session`. –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–µ—Å—Å–∏–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/login` —Å —Ç–æ—Å—Ç–æ–º ¬´–ù—É–∂–Ω–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É¬ª.
- –†–∞–∑–¥–µ–ª `/app/admin` –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É; –Ω–µ-–∞–¥–º–∏–Ω–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ `/app/dashboard` —Å —Ç–æ—Å—Ç–æ–º ¬´–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤¬ª.

## –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–ü—Ä–æ–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –Ω–∞—á–∞–ª—å–Ω–æ–π —Å—Ç–∞–¥–∏–∏. –ü–æ–ª–Ω–∞—è –¥–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ [docs/development/PLAN.md](docs/development/PLAN.md).

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:**

- ‚úÖ –ë–∞–∑–æ–≤—ã–π –∫–∞—Ä–∫–∞—Å –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (dev-—Ä–µ–∂–∏–º)
- ‚úÖ –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–π —Å–ª–æ–π –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- üöß CRM —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Vercel

–î–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: `NAV_V1=on`, `APP_LOCALE=ru`, `FIN_EXPENSES_STORAGE` (`memory` –¥–ª—è preview, `db` –¥–ª—è staging/production)
2. –ö–æ–º–∞–Ω–¥–∞ —Å–±–æ—Ä–∫–∏: `pnpm vercel-build`
3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è: Node.js 20, pnpm 9+

–ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ [docs/getting-started/setup.md](docs/getting-started/setup.md)
