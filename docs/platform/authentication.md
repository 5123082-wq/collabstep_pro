# Авторизация и регистрация

**Статус:** draft  
**Владелец:** product/engineering  
**Создан:** 2026-01-07  
**Последнее обновление:** 2026-01-07

Краткое описание текущей авторизации, регистрации и демо-доступа в Collabverse.

## 1) Назначение

Документ фиксирует текущие способы входа, регистрации и проверки сессий, а также точки интеграции с API и UI.

## 2) Текущее состояние

- Поддерживаются страницы входа и регистрации.
- В dev-режиме доступна демо-авторизация.
- Продакшен-режим использует NextAuth (email/пароль + Google OAuth).

## 3) Пользовательские маршруты (UI)

- `/login` — вход
- `/register` — регистрация
- `/app/*` — защищенные разделы приложения
- `/admin/*` — админ-раздел (требует роль admin)

## 4) API endpoints

- `POST /api/auth/login` — вход по email/паролю (dev)
- `POST /api/auth/register` — регистрация
- `POST /api/auth/logout` — выход
- `GET /api/auth/me` — текущий пользователь
- `GET/POST /api/auth/[...nextauth]` — NextAuth handlers

## 5) Данные и роли

- **User** — пользователь системы
- **Session** — сессия пользователя
- **Roles** — роли описаны в `platform/roles-permissions.md`

## 6) Переменные окружения

- `AUTH_DEV` — dev-авторизация
- `AUTH_STORAGE` — `memory` | `db`
- `AUTH_SECRET`, `NEXTAUTH_URL`
- `GOOGLE_CLIENT_ID`, `GOOGLE_CLIENT_SECRET`
- `DEMO_ADMIN_EMAIL`, `DEMO_ADMIN_PASSWORD`
- `DEMO_USER_EMAIL`, `DEMO_USER_PASSWORD`

## 7) Roadmap (draft)

### P0 — базовая фиксация

- [x] Зафиксировать способы входа: email/пароль + Google OAuth
- [ ] Описать точные правила демо-доступа и ограничения
- [ ] Зафиксировать, какие маршруты считаются защищенными

### P1 — целевые сценарии

- [ ] Описать сценарии входа/выхода/регистрации для продакшена
- [ ] Уточнить требования к хранению сессий и безопасности

### P2 — интеграции

- [ ] Определить список OAuth-провайдеров
- [ ] Описать требования к логированию и аналитике входов

## NEEDS_CONFIRMATION

- Политика паролей и требования к регистрации
- Политика хранения сессий

---

**Связанные документы:**
- [Обзор платформы](./overview.md)
- [Роли и права доступа](./roles-permissions.md)
