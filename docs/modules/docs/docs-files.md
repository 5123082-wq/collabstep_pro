# Документы — Файлы

**Статус:** partial
**Владелец:** product/engineering
**Создан:** 2026-01-07
**Последнее обновление:** 2026-01-07

## Назначение

Раздел «Файлы» в блоке «Документы» предназначен для управления документами, версиями и связанными файлами (договоры, спецификации, бренд‑гайды, презентации).

## Текущее состояние (по базе и коду)

- Сущности документов и версий реализованы на уровне доменной модели.
- Загрузка файлов поддерживается через файловые эндпоинты с `entityType=document`.
- UI‑страницы для `/docs/files` ещё не реализованы.

## Модель данных (кратко)

- **Document:** `id`, `projectId`, `title`, `type?`, `status?`, `createdAt`, `updatedAt`.
- **DocumentVersion:** `id`, `documentId`, `fileId`, `version`, `createdBy`, `createdAt`, `notes?`.
- **Связи:** документы связываются с файлами через `project_files` и наследуют доступы проекта.

## Основные сценарии

1. **Создать документ**
   - Выбрать проект, указать название, тип и статус (набор статусов будет определён отдельно).
2. **Загрузить новую версию**
   - Прикрепить файл к документу, система увеличивает `version`.
3. **Изменить метаданные**
   - Обновить название, тип, статус документа.
4. **Удалить версию или документ**
   - Удаление версии убирает только конкретный файл, удаление документа очищает и версии.
5. **Привязать к сущности**
   - Документ может быть связан с проектом или задачей через `project_files`.

## Создание

Кнопка «Создать» в разделе «Документы → Файлы» должна создавать карточку документа с первой версией файла. UI‑реализация планируется.

## Доступность по ролям

- Доступ наследуется от организации и проекта.
- Минимально требуется право чтения проекта; редактирование и загрузка версий — для участников с правом редактирования.
- Детали см. [Роли и права](../../platform/roles-permissions.md).

## Интеграции

- **Проекты и задачи:** документы видны в контексте проектов/задач и участвуют в workflow.
- **Файловый менеджер:** общий слой файлов используется для загрузки и хранения версий.
- **Организация:** документы входят в расчёт при архивировании/закрытии организаций.

## API (draft)

- `POST /api/documents/:id/files` — загрузка файла/версии (по системному анализу).
- `GET /api/files/:id` — метаданные файла.

## Связанные документы

- [Документы — Обзор](./docs-overview.md)
- [Проекты и задачи — Файлы](../projects-tasks/projects-tasks-files.md)
- [Системный анализ](../../architecture/system-analysis.md)
