# Architectural Decision Records (ADR)

**Статус:** active  
**Владелец:** engineering  
**Последнее обновление:** 2026-01-07

## Что такое ADR?

ADR (Architectural Decision Records) — это документы, которые фиксируют важные архитектурные решения, принятые в проекте. Каждый ADR документирует:

- **Контекст** — ситуация, которая привела к необходимости решения
- **Решение** — выбранный подход и его детали
- **Последствия** — положительные и отрицательные эффекты решения
- **Альтернативы** — другие варианты, которые были рассмотрены и отклонены

ADR помогают:
- Понимать причины принятых решений
- Избегать повторного обсуждения уже решенных вопросов
- Онбордить новых разработчиков
- Отслеживать эволюцию архитектуры

## Формат ADR

Каждый ADR документ следует стандартному формату:

```markdown
# ADR-XXXX: Название решения

**Статус:** Принято / Отклонено / Предложено  
**Дата:** YYYY-MM-DD  
**Владелец:** Команда/роль  
**Авторы:** Имена авторов  
**Последнее обновление:** YYYY-MM-DD

## Контекст

Описание ситуации, которая привела к необходимости решения.

## Решение

Описание выбранного подхода и его детали.

## Последствия

### Положительные
- ✅ Преимущества решения

### Отрицательные
- ⚠️ Недостатки и ограничения

### Митигация

Способы смягчения отрицательных последствий.

## Альтернативы

### Альтернатива 1: Название
**Рассмотрено:** Описание альтернативы
**Отклонено:** Причина отклонения

## Связанные документы

- Ссылки на связанные документы
```

## Список решений

| ADR | Решение | Статус | Дата |
|-----|---------|--------|------|
| [ADR-0001](./0001-canonical-database-tables.md) | Канонические таблицы для проектов и задач | Принято | 2026-01-05 |
| [ADR-0002](./0002-cache-aside-pattern.md) | Cache-aside паттерн для чтения данных | Принято | 2026-01-07 |
| [ADR-0003](./0003-nextjs-app-router.md) | Next.js App Router для фронтенда | Принято | 2026-01-07 |
| [ADR-0004](./0004-websocket-realtime.md) | WebSocket для real-time обновлений | Принято | 2026-01-07 |
| [ADR-0005](./0005-multi-account-model.md) | Мультиаккаунт через Organizations и Workspaces | Принято | 2026-01-07 |

## Как создавать новые ADR

### 1. Определить необходимость

ADR создается когда:
- Принимается важное архитектурное решение
- Выбирается технология или подход
- Решается спорный вопрос с несколькими вариантами
- Решение влияет на несколько модулей или команду

**Не создавайте ADR для:**
- Мелких технических деталей реализации
- Временных решений (hacks, workarounds)
- Решений, которые очевидны и не требуют обсуждения

### 2. Создать документ

1. Определите следующий номер ADR (последний + 1)
2. Создайте файл `docs/architecture/adr/XXXX-краткое-название.md`
3. Используйте формат выше
4. Заполните все секции (Context, Decision, Consequences, Alternatives)

### 3. Обновить индекс

Добавьте новую запись в таблицу "Список решений" в этом README.

### 4. Связать с другими документами

- Обновите [`../arc42.md`](../arc42.md#9-architectural-decisions) с ссылкой на новый ADR
- Добавьте ссылки на связанные документы в ADR
- Обновите другие документы, если решение влияет на них

## Шаблон для нового ADR

```markdown
# ADR-XXXX: Название решения

**Статус:** Предложено  
**Дата:** YYYY-MM-DD  
**Владелец:** Команда/роль  
**Авторы:** Ваше имя  
**Последнее обновление:** YYYY-MM-DD

## Контекст

Опишите ситуацию, которая привела к необходимости решения.
Какие проблемы нужно решить? Какие требования есть?

## Решение

Опишите выбранный подход и его детали.
Почему именно этот вариант? Как он будет реализован?

## Последствия

### Положительные

- ✅ Преимущество 1
- ✅ Преимущество 2

### Отрицательные

- ⚠️ Недостаток 1
- ⚠️ Недостаток 2

### Митигация

Как будут смягчены отрицательные последствия?

## Альтернативы

### Альтернатива 1: Название
**Рассмотрено:** Описание альтернативы
**Отклонено:** Причина отклонения

### Альтернатива 2: Название
**Рассмотрено:** Описание альтернативы
**Отклонено:** Причина отклонения

## Связанные документы

- [`../arc42.md`](../arc42.md) - архитектурная документация
- [`../database-architecture.md`](../database-architecture.md) - архитектура БД (если применимо)
- Другие связанные документы
```

## Обновление существующих ADR

Если решение изменилось или устарело:

1. **Обновить статус:** Изменить статус на "Отклонено" или "Заменено на ADR-YYYY"
2. **Добавить примечание:** В начале документа добавить секцию "Обновление" с датой и причиной
3. **Создать новый ADR:** Если решение заменено, создать новый ADR с ссылкой на старый
4. **Обновить индекс:** Обновить таблицу в README

## Связанные документы

- [`../arc42.md`](../arc42.md) - архитектурная документация с ссылками на ADR
- [`../database-architecture.md`](../database-architecture.md) - архитектура БД
- [`../../platform/overview.md`](../../platform/overview.md) - обзор платформы
